<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Yigong Hu" />
    
        <meta name="date" content="2022-05-16" />
    
    <title>HGWR Model and How to Use It</title>

        <script src="index_files/header-attrs-2.14/header-attrs.js"></script>
        <script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="index_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="index_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="index_files/navigation-1.1/tabsets.js"></script>
        <link href="index_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="index_files/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="index_files/readthedown-0.1/readthedown.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="style.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
        
      <h1 class="title">HGWR Model and How to Use It</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">HGWR Model and How to Use It</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#introduction-to-hgwr-model">Introduction to HGWR
      Model</a>
      <ul>
      <li><a href="#what-is-hgwr-model">What is HGWR model?</a></li>
      <li><a href="#why-hlgwr-model">Why HLGWR model?</a></li>
      </ul></li>
      <li><a href="#modelling-with-hgwr-model">Modelling with HGWR
      Model</a>
      <ul>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#usage">Usage</a></li>
      <li><a href="#example-a-small-simulated-data-set">Example: A Small
      Simulated Data Set</a></li>
      <li><a href="#example-large-scale-simulated-data">Example: Large
      Scale Simulated Data</a></li>
      </ul></li>
      <li><a href="#references">References</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Yigong
Hu</p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> 2022-05-16</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<p>A brief tutorial to Hierarchical and Geographically Weighted
Regression model and <strong>hgwrr</strong> package in R.</p>
<div id="introduction-to-hgwr-model" class="section level2">
<h2>Introduction to HGWR Model</h2>
<div id="what-is-hgwr-model" class="section level3">
<h3>What is HGWR model?</h3>
<p>Hierarchical and Geographically Weighted Regression, shorted for
HGWR, is a spatial modelling method designed for data of spatial
hierarchical structures. Just as its name implies, this is a combination
of Hierarchical Linear Model <span class="citation">(HLM, also known as
Multilevel Model, <a href="#ref-Raudenbush-1993"
role="doc-biblioref">Raudenbush 1993</a>)</span> and Geographically
Weighted Regression <span class="citation">(GWR, <a
href="#ref-BrunsdonFotheringham-1996" role="doc-biblioref">Brunsdon,
Fotheringham, and Charlton 1996</a>)</span>. In this model, spatial
effects are divided into three types: global fixed, local fixed and
random. Formally, it is expressed as <span class="math display">\[
y = G\gamma + X\beta + Z\mu + \epsilon
\]</span> with <span class="math inline">\(y\)</span> the dependent
variable, <span class="math inline">\(G\)</span> the group level
independent variables, <span class="math inline">\(\gamma\)</span> the
local fixed effects, <span class="math inline">\(X\)</span> also the
group level independent variables, <span
class="math inline">\(\beta\)</span> the global fixed effects, <span
class="math inline">\(Z\)</span> the individual level independent
variables, <span class="math inline">\(\mu\)</span> the random effects,
<span class="math inline">\(\epsilon\)</span> the individual errors.</p>
</div>
<div id="why-hlgwr-model" class="section level3">
<h3>Why HLGWR model?</h3>
<p>As we know, hierarchical structure is commonly existing in spatial
data. For example, cities can be grouped by provinces or other
higher-level administrative district they belong to; house prices may
share some factors from the block; and students in one school have
different access to education resources with those in another school.
When dealing with this type of data, we usually choose HLM to address
the within-group homogeneity and the between-group heterogeneity. And
there are usually two types of variables: group-level variables and
sample-level variables. The formal ones are used to describe the
properties of groups (such as the provinces, blocks and schools); the
latter ones are observations of individual samples (such as the cities,
houses and students). The effect of some sample-level variables are
similar in all groups, thus they are modelled with fixed coefficients
(effects). For others, they are modelled individually, i.e., with random
effects.</p>
<p>However, for group-level variables, they can only be modelled with
fixed effects. For spatial data, we would encounter some problems.
According to the Tobler’s first law of Geography “Everything is related
to everything else, but near things are more related than distant
things” <span class="citation">(<a href="#ref-Tobler-1970"
role="doc-biblioref">Tobler 1970</a>)</span>. If the model is calibrated
with equally weighted samples, spatial heterogeneity would be overlooked
<span class="citation">(<a href="#ref-FotheringhamBrunsdon-2002"
role="doc-biblioref">Fotheringham, Brunsdon, and Charlton
2002</a>)</span>. Thus, it requires us to distinguish “local fixed
effects” from “global fixed effects” to discover spatial heterogeneity
in group-level variables.</p>
<p>But why not GWR or Multiscale GWR <span class="citation">(<a
href="#ref-FotheringhamYang-2017" role="doc-biblioref">Fotheringham,
Yang, and Kang 2017, LuBrunsdon–2017</a>)</span> Because when dealing
with data of hierarchical structures, GWR is problematic <span
class="citation">(<a href="#ref-HuLu-2022" role="doc-biblioref">Hu et
al. 2022</a>)</span>. We know that GWR calibrate a model with unique
coefficients on each sample by borrowing data from its neighbours. And
it uses a parameter “bandwidth” to control how many neighbours are
included. If samples are not hierarchically structured, everything works
well. However, just imagine a situation like Figure 1. For the two
samples of red color and blue color, we take the same number of their
neighbours, but actually the spatial extents are not the same. In
extreme cases, spatial extends of some samples could be too small to
hold more than one or two location, but some are large enough. This
would lead to the failure of bandwidth optimization and reduce the
reliability of the optimized bandwidth.</p>
<video autoplay muted controls>
<source src="assets/multisampling.mp4" type="video/mp4">
</video>
<blockquote>
<p>As shown in this video, bandwidths have inequal spatial scale for two
samples (represented by cubes). Both the samples represented by large
red cubes and large blue cubes take 41 neighbour samples to calibrate
GWR models. For the red one, neighbours on 8 nearest locations are
taken. But the figure for the blue one is only 6. This situation means
estimated coefficients are more smoothed for the red samples. In other
words, estimations for the blue samples are much local.</p>
</blockquote>
<p>To solve the problems mentioned above, we need to use HGWR model. It
is able to modelling spatial hierarchical structure and spatial
heterogeneity simultaneously. Examples below can show that it works well
for spatial hierarchical data.</p>
</div>
</div>
<div id="modelling-with-hgwr-model" class="section level2">
<h2>Modelling with HGWR Model</h2>
<p>The R package <strong>hgwrr</strong> is built for calibrating HGWR
model. In this section, we are going to show how to use it.</p>
<div id="installation" class="section level3">
<h3>Installation</h3>
<p>Package <strong>hgwrr</strong> will be available on CRAN soon. Simply
type the following codes to install it.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;hgwrr&quot;</span>)</span></code></pre></div>
<p>Or download <a
href="https://github.com/HPDell/hlmgwr-backfitting-ml/releases/download/v0.2.0-r2/hgwrr_0.2-0.tar.gz">latest
released source package</a> and run the following command to install
this package.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span> CMD INSTALL hgwrr_0.2-0.tar.gz</span></code></pre></div>
<p>Note that <a
href="https://cran.r-project.org/bin/windows/Rtools/">RTools</a> is
required on Windows.</p>
</div>
<div id="usage" class="section level3">
<h3>Usage</h3>
<p>We are going to show the usage of <strong>hgwrr</strong> package with
a simulated data.</p>
<p>First, we need to load this package in an R session.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hgwrr)</span></code></pre></div>
<p>Then we can calibrate an HGWR model via <code>hgwr()</code>
function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hgwr</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  formula, data, local.fixed, coords, bw,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.01</span>, <span class="at">eps_iter =</span> <span class="fl">1e-06</span>, <span class="at">eps_gradient =</span> <span class="fl">1e-06</span>, <span class="at">max_iters =</span> <span class="fl">1e+06</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_retries =</span> <span class="dv">10</span>, <span class="at">ml_type =</span> HGWR_ML_TYPE_D_ONLY, <span class="at">verbose =</span> <span class="dv">0</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The first five arguments are mandatory.</p>
<ul>
<li><p><code>formula</code> accepts a formula object in R. Its format
follows <strong>lme4</strong> package. As there are two types of
effects: fixed effects and random effects, we use the following format
to specify both of them:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dependent <span class="sc">~</span> fixed1 <span class="sc">+</span> fixed2 <span class="sc">+</span> (random1 <span class="sc">+</span> random2 <span class="sc">|</span> group)</span></code></pre></div></li>
<li><p><code>data</code> accepts a DataFrame object in R. All variables
specified in <code>formula</code> are extracted from <code>data</code>.
In this stage, <code>Spatial*DataFrame</code> is not supported.</p></li>
<li><p><code>local.fixed</code> accepts a list of character specifying
which fixed effects are local. For example, if <code>fixed1</code> needs
to be local fixed, then set <code>local.fixed</code> to
<code>c("fixed1")</code>.</p></li>
<li><p><code>coords</code> accepts a matrix of 2 columns. Each row is
the longitude and latitude of each group.</p></li>
<li><p><code>bw</code> accepts a integer or numeric number to specify
the bandwidth used in geographically weighted process. Currently it can
only be adaptive bandwidth.</p></li>
</ul>
<p>Other arguments are optional which is used to control the backfitting
maximum likelihood algorithm. On most occassions the default values are
fine. If the default values cause some problems and you want change some
of them, please check the documentation of function <code>hgwr()</code>
for more infomation.</p>
</div>
<div id="example-a-small-simulated-data-set" class="section level3">
<h3>Example: A Small Simulated Data Set</h3>
<p><em>This example is used to show the usage of this package and to
test whether it works. We don’t care about how good the fitness of this
model is with this data set.</em></p>
<p>A data set “multisampling” is provided with this package,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(multisampling)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(multisampling<span class="sc">$</span>data)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="right">g1</th>
<th align="right">g2</th>
<th align="right">z1</th>
<th align="right">x1</th>
<th align="right">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.2311965</td>
<td align="right">0.1706889</td>
<td align="right">-0.2246718</td>
<td align="right">1.4808437</td>
<td align="right">0.7930132</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2.7154442</td>
<td align="right">0.1706889</td>
<td align="right">-0.2246718</td>
<td align="right">0.4890035</td>
<td align="right">0.5222513</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1.9980754</td>
<td align="right">0.1706889</td>
<td align="right">-0.2246718</td>
<td align="right">-0.2261288</td>
<td align="right">1.7462222</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">3.7671728</td>
<td align="right">0.1706889</td>
<td align="right">-0.2246718</td>
<td align="right">0.3268472</td>
<td align="right">-1.2713361</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">4.4938533</td>
<td align="right">0.1706889</td>
<td align="right">-0.2246718</td>
<td align="right">1.8754945</td>
<td align="right">2.1973895</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.7256683</td>
<td align="right">0.1706889</td>
<td align="right">-0.2246718</td>
<td align="right">-0.3023764</td>
<td align="right">0.4331308</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(multisampling<span class="sc">$</span>coord)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">U</th>
<th align="right">V</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2940.897</td>
<td align="right">2851.943</td>
</tr>
<tr class="even">
<td align="right">3002.659</td>
<td align="right">3157.717</td>
</tr>
<tr class="odd">
<td align="right">2848.345</td>
<td align="right">2904.326</td>
</tr>
<tr class="even">
<td align="right">2863.735</td>
<td align="right">2907.999</td>
</tr>
<tr class="odd">
<td align="right">3117.849</td>
<td align="right">2800.236</td>
</tr>
<tr class="even">
<td align="right">2906.585</td>
<td align="right">2972.770</td>
</tr>
</tbody>
</table>
</div>
<p>where <code>y</code> is the dependent variable, <code>g1</code> and
<code>g2</code> are two group-level variables, <code>z1</code> and
<code>x1</code> are two sample-level variables, <code>group</code> are
the labels of the groups they belong to, and <code>U</code>,
<code>V</code> are longitude and latitude coordinate values of all
groups.</p>
<p>We regards <code>g1</code> and <code>g2</code> have local fixed
effects, <code>x1</code> have global fixed effects and <code>z1</code>
have random effects. Then we can calibrate an HGWR model with like
this</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">hgwr</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> y <span class="sc">~</span> g1 <span class="sc">+</span> g2 <span class="sc">+</span> x1 <span class="sc">+</span> (z1 <span class="sc">|</span> group),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> multisampling<span class="sc">$</span>data,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">local.fixed =</span> <span class="fu">c</span>(<span class="st">&quot;g1&quot;</span>, <span class="st">&quot;g2&quot;</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> multisampling<span class="sc">$</span>coord,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">bw =</span> <span class="dv">10</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>model1</span></code></pre></div>
<pre><code>## Hierarchical and geographically weighted regression model 
## ========================================================= 
## Formula: y ~ g1 + g2 + x1 + (z1 | group) 
##  Method: Back-fitting and Maximum likelihood 
##    Data: multisampling$data 
## 
## Global Fixed Effects 
## ------------------- 
##   Intercept        x1 
##  501.418845  0.964527 
## 
## Local Fixed Effects 
## ------------------- 
##  Coefficient          Min  1st Quartile       Median  3rd Quartile          Max 
##    Intercept  -499.871118   -499.782545  -499.505282   -499.217001  -498.931819 
##           g1     5.920795      6.365862     7.280207      7.873304     9.253343 
##           g2    -0.932701      0.052470     0.977549      1.489318     2.170970 
## 
## Random Effects 
## -------------- 
##    Groups       Name    Std.Dev.      Corr 
##     group  Intercept  275.191529           
##                   z1   17.609290  0.063244 
##  Residual               1.900262           
## 
## Other Information 
## ----------------- 
## Number of Obs: 484 
##        Groups: group , 16</code></pre>
<p>The output of the model shows estimations of global fixed effects,
summary of those of local fixed effects. Also there are the standard
deviations of random effects and correlation coefficients between
them.</p>
<p>Then we can have a look on the coefficient estimations.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model1)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">Intercept</th>
<th align="right">g1</th>
<th align="right">g2</th>
<th align="right">x1</th>
<th align="right">z1</th>
<th align="right">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.7584048</td>
<td align="right">8.070255</td>
<td align="right">-0.0476468</td>
<td align="right">0.9645267</td>
<td align="right">-0.1886017</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">3.4049156</td>
<td align="right">7.033233</td>
<td align="right">1.3190318</td>
<td align="right">0.9645267</td>
<td align="right">0.3152164</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">0.7628029</td>
<td align="right">7.658029</td>
<td align="right">0.8462847</td>
<td align="right">0.9645267</td>
<td align="right">1.3228661</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2.4651800</td>
<td align="right">7.589579</td>
<td align="right">0.9267959</td>
<td align="right">0.9645267</td>
<td align="right">-0.6224493</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">5.8540349</td>
<td align="right">9.253343</td>
<td align="right">-0.9327007</td>
<td align="right">0.9645267</td>
<td align="right">-1.5007506</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">0.6799881</td>
<td align="right">6.228895</td>
<td align="right">1.7922811</td>
<td align="right">0.9645267</td>
<td align="right">0.7488564</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">2.6273732</td>
<td align="right">8.294855</td>
<td align="right">-0.0465259</td>
<td align="right">0.9645267</td>
<td align="right">-1.5206469</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">3.5135215</td>
<td align="right">7.963221</td>
<td align="right">0.0435419</td>
<td align="right">0.9645267</td>
<td align="right">0.3310635</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">1.0555397</td>
<td align="right">6.261015</td>
<td align="right">1.3862567</td>
<td align="right">0.9645267</td>
<td align="right">0.6204851</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">1.1190439</td>
<td align="right">5.920795</td>
<td align="right">2.1709699</td>
<td align="right">0.9645267</td>
<td align="right">-0.8916394</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">1.0778914</td>
<td align="right">6.968681</td>
<td align="right">1.3271976</td>
<td align="right">0.9645267</td>
<td align="right">0.3228212</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="right">0.4539720</td>
<td align="right">7.783387</td>
<td align="right">0.0613985</td>
<td align="right">0.9645267</td>
<td align="right">-0.4204119</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="right">0.2458550</td>
<td align="right">7.515250</td>
<td align="right">1.0283022</td>
<td align="right">0.9645267</td>
<td align="right">1.6207545</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">3.2656416</td>
<td align="right">6.117547</td>
<td align="right">1.5923796</td>
<td align="right">0.9645267</td>
<td align="right">0.0050016</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">1.8597209</td>
<td align="right">6.470709</td>
<td align="right">1.7126811</td>
<td align="right">0.9645267</td>
<td align="right">0.0483224</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="right">2.2210911</td>
<td align="right">7.045164</td>
<td align="right">0.5620939</td>
<td align="right">0.9645267</td>
<td align="right">-0.0496519</td>
<td align="right">16</td>
</tr>
</tbody>
</table>
</div>
<p>With <strong>ggplot2</strong> or other packages, we can create some
figures.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>model1_coef_coord <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(multisampling<span class="sc">$</span>coord, <span class="fu">coef</span>(model1)))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model1_coef_coord, <span class="fu">aes</span>(<span class="at">x =</span> U, <span class="at">y =</span> V)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> g1)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<p>We can also convert it to spatial data and use <strong>tmap</strong>
to visualize.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>model1_coef_coord_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(model1_coef_coord,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">coords =</span> <span class="fu">names</span>(multisampling<span class="sc">$</span>coord),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">crs =</span> <span class="dv">27700</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(model1_coef_coord_sf) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;g1&quot;</span>, <span class="st">&quot;g2&quot;</span>), <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## Variable(s) &quot;g2&quot; contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>And we can also fetch the fitted and residuals.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">real =</span> multisampling<span class="sc">$</span>data<span class="sc">$</span>y,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fitted =</span> <span class="fu">fitted</span>(model1),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> <span class="fu">residuals</span>(model1)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">real</th>
<th align="right">fitted</th>
<th align="right">residuals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.2311965</td>
<td align="right">2.6322056</td>
<td align="right">-1.401009</td>
</tr>
<tr class="even">
<td align="right">2.7154442</td>
<td align="right">2.5581112</td>
<td align="right">0.157333</td>
</tr>
<tr class="odd">
<td align="right">1.9980754</td>
<td align="right">3.8735391</td>
<td align="right">-1.875464</td>
</tr>
<tr class="even">
<td align="right">3.7671728</td>
<td align="right">0.8587312</td>
<td align="right">2.908442</td>
</tr>
<tr class="odd">
<td align="right">4.4938533</td>
<td align="right">3.9123323</td>
<td align="right">0.581521</td>
</tr>
<tr class="even">
<td align="right">0.7256683</td>
<td align="right">2.6214077</td>
<td align="right">-1.895739</td>
</tr>
</tbody>
</table>
</div>
<p>The <code>summary()</code> function will give some statistical
information about this model.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## Hierarchical and geographically weighted regression model 
## ========================================================= 
## Formula: y ~ g1 + g2 + x1 + (z1 | group) 
##  Method: Back-fitting and Maximum likelihood 
##    Data: multisampling$data 
## 
## Diagnostics 
## ----------- 
##  Rsquared 
##  0.647277 
## 
## Scaled residuals 
## ---------------- 
##        Min         1Q     Median        3Q       Max 
##  -5.457326  -1.201145  -0.066457  1.264213  5.293969 
## 
## Other Information 
## ----------------- 
## Number of Obs: 484 
##        Groups: group , 16</code></pre>
<p>On the current stage, only pesudo <span
class="math inline">\(R^2\)</span> is available. In the future, more
diagnostic information will be provided in this package.</p>
</div>
<div id="example-large-scale-simulated-data" class="section level3">
<h3>Example: Large Scale Simulated Data</h3>
<p>In the former example, there are only 484 observations and 16 groups.
They are not adequate enough to get precises estimations. Here, we are
going to use a large scale simulated data set to show the perforamnce of
HGWR model. As the true value of coefficients are already known (stored
in variable <code>hgwr_beta</code>), closeness between estimated and
true values is an appliable perforamnce metric.</p>
<p>The data set is provided <a href="./data/example2.rda">here</a>. Its
structure is similar to data <code>multisampling</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hgwrr)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/example2.rda&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hgwr_data)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="right">g1</th>
<th align="right">g2</th>
<th align="right">x1</th>
<th align="right">z1</th>
<th align="right">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2.090256</td>
<td align="right">0.1933745</td>
<td align="right">-0.057836</td>
<td align="right">0.7930132</td>
<td align="right">1.1432041</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">3.456452</td>
<td align="right">0.1933745</td>
<td align="right">-0.057836</td>
<td align="right">0.5222513</td>
<td align="right">1.0198745</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2.876627</td>
<td align="right">0.1933745</td>
<td align="right">-0.057836</td>
<td align="right">1.7462222</td>
<td align="right">-0.7071740</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">4.510162</td>
<td align="right">0.1933745</td>
<td align="right">-0.057836</td>
<td align="right">-1.2713361</td>
<td align="right">0.8431381</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">5.583738</td>
<td align="right">0.1933745</td>
<td align="right">-0.057836</td>
<td align="right">2.1973895</td>
<td align="right">-0.1603318</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1.601511</td>
<td align="right">0.1933745</td>
<td align="right">-0.057836</td>
<td align="right">0.4331308</td>
<td align="right">-0.7634945</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hgwr_coords)</span></code></pre></div>
<pre><code>##            V1       V2
## [1,] 2940.897 2851.943
## [2,] 3002.659 3157.717
## [3,] 2848.345 2904.326
## [4,] 2863.735 2907.999
## [5,] 3117.849 2800.236
## [6,] 2906.585 2972.770</code></pre>
<p>In this data, we also regards <code>g1</code> and <code>g2</code> as
two group-level variables, <code>z1</code> and <code>x1</code> as two
sample-level variables, <code>group</code> as the labels of the groups
they belong to, and <code>U</code>, <code>V</code> as longitude and
latitude coordinate values of all groups. Then we calibrate an HGWR
model.</p>
<blockquote>
<p>As the data is large (13862 observations), it may take some time to
get results.</p>
</blockquote>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hgwr_formula <span class="ot">&lt;-</span> y <span class="sc">~</span> g1 <span class="sc">+</span> g2 <span class="sc">+</span> x1 <span class="sc">+</span> (z1 <span class="sc">|</span> group)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">hgwr</span>(<span class="at">formula =</span> hgwr_formula,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> hgwr_data,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">local.fixed =</span> <span class="fu">c</span>(<span class="st">&quot;g1&quot;</span>, <span class="st">&quot;g2&quot;</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">coords =</span> hgwr_coords,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">bw =</span> <span class="dv">32</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">kernel =</span> <span class="st">&quot;bisquared&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>model2</span></code></pre></div>
<pre><code>## Hierarchical and geographically weighted regression model 
## ========================================================= 
## Formula: hgwr_formula 
##  Method: Back-fitting and Maximum likelihood 
##    Data: hgwr_data 
## 
## Global Fixed Effects 
## ------------------- 
##  Intercept        x1 
##   2.903959  1.010693 
## 
## Local Fixed Effects 
## ------------------- 
##  Coefficient         Min  1st Quartile     Median  3rd Quartile        Max 
##    Intercept   -1.855908     -1.257154  -1.091754     -0.926817  -0.419757 
##           g1   -3.225655      0.389393   3.577700      6.402320  11.857704 
##           g2  -10.924379     -2.421625  -0.339577      1.882330   8.465074 
## 
## Random Effects 
## -------------- 
##    Groups       Name  Std.Dev.       Corr 
##     group  Intercept  1.786990            
##                   z1  1.816209  -0.205140 
##  Residual             1.991082            
## 
## Other Information 
## ----------------- 
## Number of Obs: 13862 
##        Groups: group , 200</code></pre>
<p>Then we check the estimations of intercept, <code>g1</code>,
<code>g2</code> and <code>z1</code> via some scatter plots.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;g1&quot;</span>, <span class="st">&quot;g2&quot;</span>, <span class="st">&quot;z1&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="cf">function</span>(coef, beta_true, beta_hat) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">data.frame</span>(<span class="at">label =</span> coef, <span class="at">Truth =</span> beta_true[[coef]], <span class="at">Estimated =</span> beta_hat[[coef]])</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  }, hgwr_beta, <span class="fu">coef</span>(model2)) <span class="sc">%&gt;%</span> {</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Reduce</span>(rbind, ., <span class="fu">data.frame</span>())</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  } <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">factor</span>(label, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;g1&quot;</span>, <span class="st">&quot;g2&quot;</span>, <span class="st">&quot;z1&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Truth, <span class="at">y =</span> Estimated)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> label) <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">25</span>, <span class="dv">25</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-BrunsdonFotheringham-1996" class="csl-entry">
Brunsdon, Chris, A. Stewart Fotheringham, and Martin E. Charlton. 1996.
<span>“Geographically <span>Weighted Regression</span>: <span>A
Method</span> for <span>Exploring Spatial
Nonstationarity</span>.”</span> <em>Geographical Analysis</em> 28 (4):
281–98. <a
href="https://doi.org/10.1111/j.1538-4632.1996.tb00936.x">https://doi.org/10.1111/j.1538-4632.1996.tb00936.x</a>.
</div>
<div id="ref-FotheringhamBrunsdon-2002" class="csl-entry">
Fotheringham, A. Stewart, Chris Brunsdon, and Martin Charlton. 2002.
<em>Geographically Weighted Regression: The Analysis of Spatially
Varying Relationships</em>. <span>Chichester, England ; Hoboken, NJ,
USA</span>: <span>Wiley</span>.
</div>
<div id="ref-FotheringhamYang-2017" class="csl-entry">
Fotheringham, A. Stewart, Wenbai Yang, and Wei Kang. 2017.
<span>“Multiscale <span>Geographically Weighted Regression</span>
(<span>MGWR</span>).”</span> <em>Annals of the American Association of
Geographers</em> 107 (6): 1247–65. <a
href="https://doi.org/10.1080/24694452.2017.1352480">https://doi.org/10.1080/24694452.2017.1352480</a>.
</div>
<div id="ref-HuLu-2022" class="csl-entry">
Hu, Yigong, Binbin Lu, Yong Ge, and Guanpeng Dong. 2022.
<span>“Uncovering Spatial Heterogeneity in Real Estate Prices via
Combined Hierarchical Linear Model and Geographically Weighted
Regression.”</span> <em>Environment and Planning B: Urban Analytics and
City Science</em>, January, 239980832110638. <a
href="https://doi.org/10.1177/23998083211063885">https://doi.org/10.1177/23998083211063885</a>.
</div>
<div id="ref-Raudenbush-1993" class="csl-entry">
Raudenbush, Stephen W. 1993. <span>“Hierarchical <span>Linear
Models</span> and <span>Experimental Design</span>.”</span> In
<em>Applied Analysis of Variance in Behavioral Science</em>, 459–96.
<span>L. K. Edwards</span>.
</div>
<div id="ref-Tobler-1970" class="csl-entry">
Tobler, W. R. 1970. <span>“A <span>Computer Movie Simulating Urban
Growth</span> in the <span>Detroit Region</span>.”</span> <em>Economic
Geography</em> 46 (June): 234. <a
href="https://doi.org/10.2307/143141">https://doi.org/10.2307/143141</a>.
</div>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
